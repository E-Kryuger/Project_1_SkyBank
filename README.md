# SkyBank — анализ банковских операций

## Описание

Этот проект представляет собой приложение для анализа транзакций, которые находятся в Excel-файле

## Функциональность

SkyBank включает следующие модули:

- main.py
- reports.py
- services.py
- utils.py
- views.py

### Обзор функциональных модулей:

#### src/utils.py
Модуль, содержащий функции для обработки данных и выполнения операций, связанных с веб-страницами. 
Основные функции включают:
- `text_of_the_greeting`: функция, которая смотрит на текущее время и возвращает приветствие («Доброе утро» / «Добрый день» / «Добрый вечер» / «Доброй ночи»)
- `data_from_excel`: загружает данные из Excel-файла и возвращает их в виде DataFrame.
- `filter_transactions_by_date`: Фильтрует транзакции по заданной дате и возвращает соответствующий DataFrame.
- `calculate_card_info`: вычисляет информацию по картам, включая общую сумму расходов и кешбэк
- `top_transactions`: функция, которая ищет топ 5 транзакций и выводит данные по ним
- `data_from_user_settings`: экспортирует настройки пользователя из файла JSON
- `info_currency_rates`: функция, которая собирает данные по валютам, исходя из пользовательских настроек
- `info_stock_prices`: функция, которая собирает данные по акциям, исходя из пользовательских настроек

#### src/reports.py
Модуль, отвечающий за генерацию отчетов на основе данных о транзакциях. 
Основные функции модуля включают:
- `report_decorator`: декоратор, который записывает результат функции-отчета в файл. Если имя файла не указано, используется имя по умолчанию, содержащее текущую дату и время.
- `spending_by_category`: функция, которая возвращает траты по заданной категории за последние три месяца от заданной даты

#### src/services.py
Модуль, предоставляющий функционал простого поиска. 
Основные функции модуля включают:
- `dataframe_to_dict_with_str`: преобразует DataFrame в список словарей
- `search_transactions`: ищет транзакции в описании или категории, которых присутствует заданный поисковой запрос и возвращает JSON-ответ с данными этих операций

#### src/views.py
Модуль, отвечающий за формирование и представление JSON-ответов на основе обработанных данных. 
Основная функция:
- `form_json_response`: Формирует JSON-ответ, объединяя функции из <u>**src/utils.py**</u>


#### main.py
Основной модуль, который обеспечивает запуск приложения и взаимодействие с другими модулями для обработки данных.


## Зависимости

python = "^3.12"\
requests = "^2.32.3"\
python-dotenv = "^1.0.1"\
pandas = "^2.2.3"\
mypy = "^1.11.2"\
flake8 = "^7.1.1"\
black = "^24.8.0"\
isort = "^5.13.2"\
pytest = "^8.3.3"\
pytest-cov = "^5.0.0"

## Установка

1. Клонируйте репозиторий:
```
https://github.com/E-Kryuger/Project_2_SkyBank.git
```
2. Установите зависимости:
```
poetry install
```

## Тестирование проекта

Тестирование проекта проводится с использованием пакета tests, который включает следующие файлы:

- init.py
- conftest.py
- test_reports.py
- test_services.py
- test_utils.py


### Есть два способа выполнить тестирование проекта:
1. Используя терминал PyCharm:
```
pytest tests
```
2. Используя функциональность PyCharm:
- Откройте окно **Edit Configurations**.
- Выберите **pytest**.
- Укажите директорию, содержащую тесты, и директорию проекта.
- Подтвердите изменения, нажав **Apply** и **OK**.
- Запустите **pytest in tests**
